# """Input"""
# print("Input corp_id: ")
# # co_id = input()
# print('Input year: ')
# # year = input()

# """Initializing Driver"""
# driver = webdriver.Chrome(service=Service(ChromeDriverManager().install()))
# co_id = "2330"
# year = "109"
# driver.get("https://doc.twse.com.tw/server-java/t57sb01?step=1&colorchg=1&co_id="+co_id+"&year="+year+"&seamon=&mtype=A&")
# # driver.find_element_by_xpath("/html/body/center/form/table[2]/tbody/tr[9]/td[8]/a").click()

# """First page"""
# # Receive 10 elements, which is different kind of financial statements. First index is column header, need to be skipped
# # Try first one to download pdf file
# table = driver.find_elements(By.XPATH,"/html/body/center/form/table[2]/tbody/tr")[1]
# # print(len(table))
# url = driver.find_element(By.PARTIAL_LINK_TEXT, ".pdf")
# text = url.text
# print(text)
# url.click()
# # time.sleep(2)

# """Second Page (new windows) --> Need to switch to new windows"""
# search_windows = driver.current_window_handle
# # print(search_windows)

# # 獲得當前所有開啟的視窗的控制程式碼，只適用於出現的第二個視窗 --> 可以用list的方法進行改進 (ex:取最後一個 all_handles[-1])
# all_handles = driver.window_handles
# for handle in all_handles:
#  if handle != search_windows:
#   driver.switch_to.window(handle)
#   print(driver.current_url + "\tURL has changed")
#  else:
#   print('當前頁面url: %s'%driver.current_url)

# wait = WebDriverWait(driver, 10)
# element = wait.until(EC.element_to_be_clickable((By.LINK_TEXT, text)))
# pdf = driver.find_element(By.LINK_TEXT, text)
# pdf.click()

# """Third Page, Financial statement Page"""
# #Download the PDF file here
# urls = [driver.current_url]
# output_dir = os.path.join(os.getcwd(), co_id)
# if ~os.path.exists(output_dir):
#     os.makedirs(output_dir)
# for url in urls:
#     response = requests.get(url)
#     if response.status_code == 200:
#         file_path = os.path.join(output_dir, os.path.basename(url))
#         with open(file_path, "wb") as f:
#             f.write(response.content)            
# time.sleep(10)
# print("Download success !")

# """ Shutdown Chrome drive """
# driver.quit()